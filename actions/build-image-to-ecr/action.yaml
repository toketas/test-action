name: Build Image to ECR
description: A composite action to build image to ECR

runs:
  using: composite
  steps:
    - name: Dump GitHub context
      env:
        GITHUB_CONTEXT: ${{ toJson(github) }}
      run: echo "$GITHUB_CONTEXT"
    - name: Dump job context
      env:
        JOB_CONTEXT: ${{ toJson(job) }}
      run: echo "$JOB_CONTEXT"
    - name: Dump steps context
      env:
        STEPS_CONTEXT: ${{ toJson(steps) }}
      run: echo "$STEPS_CONTEXT"
    - name: Dump runner context
      env:
        RUNNER_CONTEXT: ${{ toJson(runner) }}
      run: echo "$RUNNER_CONTEXT"
    - name: Dump strategy context
      env:
        STRATEGY_CONTEXT: ${{ toJson(strategy) }}
      run: echo "$STRATEGY_CONTEXT"
    - name: Dump matrix context
      env:
        MATRIX_CONTEXT: ${{ toJson(matrix) }}
      run: echo "$MATRIX_CONTEXT"

    #- name: Check out repository
    #  uses: actions/checkout@4

    #- name: Setup Docker Buildx
    #  uses: docker/setup-buildx-action@v3

    #- name: Configure AWS Credentials
    #  uses: aws-actions/configure-aws-credentials@v4
    #  with:
    #    role-to-assume: ${{ vars.AWS_CREDS_ROLE_TO_ASSUME }}
    #    aws-region: ${{ vars.AWS_REGION }}

    #- name: Login to ECR ${{ vars.ECR_URL }}
    #  uses: docker/login-action@v3
    #  with:
    #    registry: ${{ vars.ECR_URL }}

    #- name: Build image
    #  uses: docker/build-push-action@v5
    #  with:
    #    push: true
    #    cache-from: type=gha
    #    cache-to: type=gha,mode=max
    #    context: ${{ inputs.docker-build-context }}
    #    target: ${{ inputs.docker-build-target }}
    #    file: ${{ inputs.docker-file-path }}
    #    tags: |
    #      ${{ vars.ECR_URL }}/${{ vars.ECR_REPO }}:latest
    #      ${{ vars.ECR_URL }}/${{ vars.ECR_REPO }}:${{ inputs.docker-tag }}
    #    build-args: |
    #      GH_ACCESS_TOKEN=${{ secrets.GH_ACCESS_TOKEN }}
    #      PIP_EXTRA_INDEX_URL=${{ secrets.PIP_EXTRA_INDEX_URL }}
    #      ${{ inputs.docker-build-args }}
